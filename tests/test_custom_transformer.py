def test_custom_transformer():
    from . import testing_functions
    import logging
    import ontoweaver
    from tests.custom_transformer.custom import OmniPath

    logging.basicConfig(level=logging.DEBUG)

    directory_name = "custom_transformer"

    assert_nodes = [('Q92796:protein', 'protein', {'genesymbol': 'DLG3', 'ncbi_tax_id': '9606'}),
                    ('P09172:protein', 'protein', {'genesymbol': 'DBH', 'ncbi_tax_id': '9606'}),
                    ('P03372:protein', 'protein', {'genesymbol': 'ESR1', 'ncbi_tax_id': '9606'}),
                    ('P42336:protein', 'protein', {'genesymbol': 'PIK3CA', 'ncbi_tax_id': '9606'}),
                    ('htr2a-as1:lncrna', 'lncrna', {'name': 'htr2a-as1', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:Q13546_Q9Y572:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'RIPK1_RIPK3', 'ncbi_tax_id': '9606'}),
                    ('P05114:protein', 'protein', {'genesymbol': 'HMGN1', 'ncbi_tax_id': '9606'}),
                    ('MIMAT0000462:mirna', 'mirna', {'name': 'hsa-miR-206', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:P60604_P62979:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'RPS27A_UBE2G2', 'ncbi_tax_id': '9606'}),
                    ('P12004:protein', 'protein', {'genesymbol': 'PCNA', 'ncbi_tax_id': '9606'}),
                    ('Q5TC82:protein', 'protein', {'genesymbol': 'RC3H1', 'ncbi_tax_id': '9606'}),
                    ('Q9Y4A5:protein', 'protein', {'genesymbol': 'TRRAP', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:P42229_Q00978:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'IRF9_STAT5A', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:Q04206_Q04864:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'REL_RELA', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:CHEBI:166824_P30511_P61769:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'B2M_CHEBI:166824_HLA-F', 'ncbi_tax_id': '9606'}),
                    ('Q9JMA7:protein', 'protein', {'genesymbol': 'Cyp3a41a; Cyp3a41b', 'ncbi_tax_id': '10090'}),
                    ('P61764:protein', 'protein', {'genesymbol': 'STXBP1', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:P60880_P63027_Q16623:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'SNAP25_STX1A_VAMP2', 'ncbi_tax_id': '9606'}),
                    ('MIMAT0000100:mirna', 'mirna', {'name': 'hsa-miR-29b', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:A5YKK6_O75175_O95628_Q92600_Q96LI5_Q9C0C2_Q9H9A5_Q9NZN8_Q9UFF9_Q9UIV1_Q9UKZ1_Q9ULM6:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'CNOT1_CNOT10_CNOT11_CNOT2_CNOT3_CNOT4_CNOT6_CNOT6L_CNOT7_CNOT8_CNOT9_TNKS1BP1', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:O95264_P46098:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'HTR3A_HTR3B', 'ncbi_tax_id': '9606'}),
                    ('Q9C030:protein', 'protein', {'genesymbol': 'TRIM6', 'ncbi_tax_id': '9606'}),
                    ('46220502:drug', 'drug', {'name': '46220502', 'ncbi_tax_id': '-1'}),
                    ('MIMAT0000266:mirna', 'mirna', {'name': 'PTPRM', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:Q05586_Q12879:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'GRIN1_GRIN2A', 'ncbi_tax_id': '9606'}),
                    ('P28827:protein', 'protein', {'genesymbol': 'PTPRM', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:P01848_P01850_P04234_P07766_P09693_P20963:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'CD247_CD3D_CD3E_CD3G_TRAC_TRBC1', 'ncbi_tax_id': '9606'}),
                    ('COMPLEX:P17535_P53539:macromolecular_complex', 'macromolecular_complex', {'genesymbol': 'FOSB_JUND', 'ncbi_tax_id': '9606'}),
                    ('P08151:protein', 'protein', {'genesymbol': 'GLI1', 'ncbi_tax_id': '9606'}),
                    ('MIMAT0000281:mirna', 'mirna', {'name': 'hsa-miR-224-5p', 'ncbi_tax_id': '9606'}),
                    ('P48281:protein', 'protein', {'genesymbol': 'Vdr', 'ncbi_tax_id': '10090'}),
                    ('5202:drug', 'drug', {'name': '5202', 'ncbi_tax_id': '-1'}),
                    ]

    assert_edges = [('', '46220502:drug', 'P42336:protein', 'drug_has_target', {'is_directed': 'True', 'is_stimulation': 'False', 'is_inhibition': 'False', 'consensus_direction': 'False', 'consensus_stimulation': 'False', 'consensus_inhibition': 'False', 'sources': 'CancerDrugsDB', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'True', 'type': 'small_molecule_protein', 'curation_effort': '0', 'extra_attrs': '{}', 'evidences': '{"id_a":"46220502","id_b":"P42336","positive":[],"negative":[],"directed":[{"resource":"CancerDrugsDB","references":[],"dataset":"small_molecule","via":null,"attrs":{}}],"undirected":[]}'}),
                    ('', 'P08151:protein', 'MIMAT0000100:mirna', 'mirna_transcriptional', {'is_directed': 'True', 'is_stimulation': 'False', 'is_inhibition': 'True', 'consensus_direction': 'True', 'consensus_stimulation': 'False', 'consensus_inhibition': 'True', 'sources': 'TransmiR', 'references': 'TransmiR:20564213', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'True', 'small_molecule': 'False', 'type': 'mirna_transcriptional', 'curation_effort': '1', 'extra_attrs': '{}', 'evidences': '{"id_a":"P08151","id_b":"MIMAT0000100","positive":[],"negative":[{"resource":"TransmiR","references":["20564213"],"dataset":"tf_mirna","via":null,"attrs":{}}],"directed":[],"undirected":[]}'}),
                    ('', 'COMPLEX:P60604_P62979:macromolecular_complex', 'Q9C030:protein', 'post_translational', {'is_directed': 'True', 'is_stimulation': 'True', 'is_inhibition': 'False', 'consensus_direction': 'True', 'consensus_stimulation': 'True', 'consensus_inhibition': 'False', 'sources': 'SIGNOR', 'references': 'SIGNOR:34199813', 'omnipath': 'True', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'post_translational', 'curation_effort': '1', 'extra_attrs': '{"SIGNOR_mechanism":["ubiquitination"]}', 'evidences': '{"id_a":"COMPLEX:P60604_P62979","id_b":"Q9C030","positive":[{"resource":"SIGNOR","references":["34199813"],"dataset":"omnipath","via":null,"attrs":{"mechanism":["ubiquitination"]}}],"negative":[],"directed":[],"undirected":[]}'}),
                    ('', 'htr2a-as1:lncrna', 'P12004:protein', 'lncrna_post_transcriptional', {'is_directed': 'True', 'is_stimulation': 'False', 'is_inhibition': 'False', 'consensus_direction': 'False', 'consensus_stimulation': 'False', 'consensus_inhibition': 'False', 'sources': 'ncRDeathDB', 'references': 'ncRDeathDB:17932748', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'True', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'lncrna_post_transcriptional', 'curation_effort': '1', 'extra_attrs': '{"ncRDeathDB_pathway":"apoptosis","ncRDeathDB_effect":"down"}', 'evidences': '{"id_a":"htr2a-as1","id_b":"P12004","positive":[],"negative":[],"directed":[{"resource":"ncRDeathDB","references":["17932748"],"dataset":"lncrna_mrna","via":null,"attrs":{"pathway":"apoptosis","effect":"down"}}],"undirected":[]}'}),
                    ('', 'COMPLEX:A5YKK6_O75175_O95628_Q92600_Q96LI5_Q9C0C2_Q9H9A5_Q9NZN8_Q9UFF9_Q9UIV1_Q9UKZ1_Q9ULM6:macromolecular_complex', 'Q5TC82:protein', 'post_transcriptional', {'is_directed': 'True', 'is_stimulation': 'False', 'is_inhibition': 'True', 'consensus_direction': 'True', 'consensus_stimulation': 'False', 'consensus_inhibition': 'True', 'sources': 'SIGNOR', 'references': 'SIGNOR:31320642', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'True', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'post_transcriptional', 'curation_effort': '1', 'extra_attrs': '{"SIGNOR_mechanism":["post transcriptional regulation"]}', 'evidences': '{"id_a":"COMPLEX:A5YKK6_O75175_O95628_Q92600_Q96LI5_Q9C0C2_Q9H9A5_Q9NZN8_Q9UFF9_Q9UIV1_Q9UKZ1_Q9ULM6","id_b":"Q5TC82","positive":[],"negative":[{"resource":"SIGNOR","references":["31320642"],"dataset":"mirnatarget","via":null,"attrs":{"mechanism":["post transcriptional regulation"]}}],"directed":[],"undirected":[]}'}),
                    ('', 'Q92796:protein', 'COMPLEX:Q05586_Q12879:macromolecular_complex', 'post_translational', {'is_directed': 'True', 'is_stimulation': 'True', 'is_inhibition': 'False', 'consensus_direction': 'True', 'consensus_stimulation': 'True', 'consensus_inhibition': 'False', 'sources': 'SIGNOR', 'references': 'SIGNOR:32904533', 'omnipath': 'True', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'post_translational', 'curation_effort': '1', 'extra_attrs': '{"SIGNOR_mechanism":["relocalization"]}', 'evidences': '{"id_a":"Q92796","id_b":"COMPLEX:Q05586_Q12879","positive":[{"resource":"SIGNOR","references":["32904533"],"dataset":"omnipath","via":null,"attrs":{"mechanism":["relocalization"]}}],"negative":[],"directed":[],"undirected":[]}'}),
                    ('', 'P05114:protein', 'Q9Y4A5:protein', 'post_translational', {'is_directed': 'True', 'is_stimulation': 'True', 'is_inhibition': 'False', 'consensus_direction': 'True', 'consensus_stimulation': 'True', 'consensus_inhibition': 'False', 'sources': 'SPIKE;SPIKE_LC', 'references': 'SPIKE:16096646;SPIKE_LC:16096646', 'omnipath': 'True', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'True', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'post_translational', 'curation_effort': '2', 'extra_attrs': '{"SPIKE_effect":"1","SPIKE_mechanism":"Other","SPIKE_LC_effect":"1","SPIKE_LC_mechanism":"Other"}', 'evidences': '{"id_a":"P05114","id_b":"Q9Y4A5","positive":[{"resource":"SPIKE","references":["16096646"],"dataset":"omnipath","via":null,"attrs":{"effect":"1","mechanism":"Other"}},{"resource":"SPIKE_LC","references":["16096646"],"dataset":"pathwayextra","via":null,"attrs":{"effect":"1","mechanism":"Other"}}],"negative":[],"directed":[],"undirected":[]}'}),
                    ('', 'P61764:protein', 'COMPLEX:P60880_P63027_Q16623:macromolecular_complex', 'transcriptional', {'is_directed': 'True', 'is_stimulation': 'True', 'is_inhibition': 'False', 'consensus_direction': 'True', 'consensus_stimulation': 'True', 'consensus_inhibition': 'False', 'sources': 'SIGNOR', 'references': 'SIGNOR:30267828', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'True', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'transcriptional', 'curation_effort': '1', 'extra_attrs': '{"SIGNOR_mechanism":["transcriptional regulation"]}', 'evidences': '{"id_a":"P61764","id_b":"COMPLEX:P60880_P63027_Q16623","positive":[{"resource":"SIGNOR","references":["30267828"],"dataset":"tf_target","via":null,"attrs":{"mechanism":["transcriptional regulation"]}}],"negative":[],"directed":[],"undirected":[]}'}),
                    ('', '5202:drug', 'COMPLEX:O95264_P46098:macromolecular_complex', 'drug_has_target', {'is_directed': 'True', 'is_stimulation': 'False', 'is_inhibition': 'False', 'consensus_direction': 'False', 'consensus_stimulation': 'False', 'consensus_inhibition': 'False', 'sources': 'Cellinker;Guide2Pharma_Cellinker', 'references': 'Cellinker:10521471;Cellinker:10825381;Cellinker:16081679;Cellinker:9950429', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'True', 'type': 'small_molecule_protein', 'curation_effort': '4', 'extra_attrs': '{}', 'evidences': '{"id_a":"5202","id_b":"COMPLEX:O95264_P46098","positive":[],"negative":[],"directed":[{"resource":"Guide2Pharma","references":[],"dataset":"small_molecule","via":"Cellinker","attrs":{}},{"resource":"Cellinker","references":["10521471","16081679","9950429","10825381"],"dataset":"small_molecule","via":null,"attrs":{}}],"undirected":[]}'}),
                    ('', 'COMPLEX:P42229_Q00978:macromolecular_complex', 'COMPLEX:Q13546_Q9Y572:macromolecular_complex', 'transcriptional', {'is_directed': 'True', 'is_stimulation': 'True', 'is_inhibition': 'False', 'consensus_direction': 'True', 'consensus_stimulation': 'True', 'consensus_inhibition': 'False', 'sources': 'KEGG-MEDICUS', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'True', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'transcriptional', 'curation_effort': '0', 'extra_attrs': '{}', 'evidences': '{"id_a":"COMPLEX:P42229_Q00978","id_b":"COMPLEX:Q13546_Q9Y572","positive":[{"resource":"KEGG-MEDICUS","references":[],"dataset":"tf_target","via":null,"attrs":{}}],"negative":[],"directed":[],"undirected":[]}'}),
                    ('', 'COMPLEX:P17535_P53539:macromolecular_complex', 'P09172:protein', 'transcriptional', {'is_directed': 'True', 'is_stimulation': 'True', 'is_inhibition': 'False', 'consensus_direction': 'True', 'consensus_stimulation': 'True', 'consensus_inhibition': 'False', 'sources': 'CollecTRI;ExTRI_CollecTRI;GEREDB_CollecTRI;NTNU.Curated_CollecTRI', 'references': 'CollecTRI:10908602;CollecTRI:8597411;CollecTRI:9727025', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'True', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'transcriptional', 'curation_effort': '3', 'extra_attrs': '{"CollecTRI_tf_category":"dbTF","CollecTRI_sign_decision":"PMID"}', 'evidences': '{"id_a":"COMPLEX:P17535_P53539","id_b":"P09172","positive":[{"resource":"NTNU.Curated","references":[],"dataset":"collectri","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":"PMID"}},{"resource":"GEREDB","references":[],"dataset":"collectri","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":"PMID"}},{"resource":"ExTRI","references":[],"dataset":"collectri","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":"PMID"}},{"resource":"CollecTRI","references":["8597411","9727025","10908602"],"dataset":"collectri","via":null,"attrs":{"tf_category":"dbTF","sign_decision":"PMID"}}],"negative":[],"directed":[],"undirected":[]}'}),
                    ('', 'MIMAT0000266:mirna', 'P28827:protein', 'post_transcriptional', {'is_directed': 'True', 'is_stimulation': 'False', 'is_inhibition': 'False', 'consensus_direction': 'False', 'consensus_stimulation': 'False', 'consensus_inhibition': 'False', 'sources': 'miRTarBase', 'references': 'miRTarBase:23497265', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'True', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'post_transcriptional', 'curation_effort': '1', 'extra_attrs': '{"miRTarBase_method":["Immunohistochemistry","Luciferase reporter assay","Microarray","QRTPCR"]}', 'evidences': '{"id_a":"MIMAT0000266","id_b":"P28827","positive":[],"negative":[],"directed":[{"resource":"miRTarBase","references":["23497265"],"dataset":"mirnatarget","via":null,"attrs":{"method":["Immunohistochemistry","Luciferase reporter assay","Microarray","QRTPCR"]}}],"undirected":[]}'}),
                    ('', 'P03372:protein', 'MIMAT0000462:mirna', 'transcriptional', {'is_directed': 'True', 'is_stimulation': 'False', 'is_inhibition': 'True', 'consensus_direction': 'True', 'consensus_stimulation': 'False', 'consensus_inhibition': 'True', 'sources': 'CollecTRI;GEREDB_CollecTRI', 'references': 'CollecTRI:17312270', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'True', 'small_molecule': 'False', 'type': 'transcriptional', 'curation_effort': '1', 'extra_attrs': '{"CollecTRI_tf_category":"dbTF","CollecTRI_sign_decision":"PMID"}', 'evidences': '{"id_a":"P03372","id_b":"MIMAT0000462","positive":[],"negative":[{"resource":"GEREDB","references":[],"dataset":"tf_mirna","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":"PMID"}},{"resource":"CollecTRI","references":["17312270"],"dataset":"tf_mirna","via":null,"attrs":{"tf_category":"dbTF","sign_decision":"PMID"}}],"directed":[],"undirected":[]}'}),
                    ('', 'COMPLEX:CHEBI:166824_P30511_P61769:macromolecular_complex', 'COMPLEX:P01848_P01850_P04234_P07766_P09693_P20963:macromolecular_complex', 'post_translational', {'is_directed': 'True', 'is_stimulation': 'True', 'is_inhibition': 'False', 'consensus_direction': 'True', 'consensus_stimulation': 'True', 'consensus_inhibition': 'False', 'sources': 'SIGNOR', 'references': 'SIGNOR:31001252', 'omnipath': 'True', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'type': 'post_translational', 'curation_effort': '1', 'extra_attrs': '{"SIGNOR_mechanism":["binding"]}', 'evidences': '{"id_a":"COMPLEX:CHEBI:166824_P30511_P61769","id_b":"COMPLEX:P01848_P01850_P04234_P07766_P09693_P20963","positive":[{"resource":"SIGNOR","references":["31001252"],"dataset":"omnipath","via":null,"attrs":{"mechanism":["binding"]}}],"negative":[],"directed":[],"undirected":[]}'}),
                    ('', 'COMPLEX:Q04206_Q04864:macromolecular_complex', 'MIMAT0000281:mirna', 'transcriptional', {'is_directed': 'True', 'is_stimulation': 'True', 'is_inhibition': 'False', 'consensus_direction': 'True', 'consensus_stimulation': 'True', 'consensus_inhibition': 'False', 'sources': 'CollecTRI;ExTRI_CollecTRI', 'references': 'CollecTRI:23474441;CollecTRI:23988648', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'False', 'collectri': 'False', 'tf_target': 'False', 'lncrna_mrna': 'False', 'tf_mirna': 'True', 'small_molecule': 'False', 'type': 'transcriptional', 'curation_effort': '2', 'extra_attrs': '{"CollecTRI_tf_category":"dbTF","CollecTRI_sign_decision":"default activation"}', 'evidences': '{"id_a":"COMPLEX:Q04206_Q04864","id_b":"MIMAT0000281","positive":[{"resource":"ExTRI","references":[],"dataset":"tf_mirna","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":"default activation"}},{"resource":"CollecTRI","references":["23474441","23988648"],"dataset":"tf_mirna","via":null,"attrs":{"tf_category":"dbTF","sign_decision":"default activation"}}],"negative":[],"directed":[],"undirected":[]}'}),
                    ('', 'P48281:protein', 'Q9JMA7:protein', 'transcriptional', {'is_directed': 'True', 'is_stimulation': 'True', 'is_inhibition': 'False', 'consensus_direction': 'True', 'consensus_stimulation': 'True', 'consensus_inhibition': 'False', 'sources': 'CollecTRI;DoRothEA;DoRothEA-A_CollecTRI;ExTRI_CollecTRI;HTRI_CollecTRI;HTRIdb;HTRIdb_DoRothEA;NTNU.Curated_CollecTRI;SIGNOR_CollecTRI;TRRUST;TRRUST_CollecTRI;TRRUST_DoRothEA', 'references': 'CollecTRI:11723248;CollecTRI:11991950;CollecTRI:12147248;CollecTRI:12167569;CollecTRI:15205382;CollecTRI:15358113;CollecTRI:18400206;CollecTRI:19581388;CollecTRI:19712670;CollecTRI:22939842;DoRothEA:15358113;DoRothEA:22939842;HTRIdb:19712670;TRRUST:11723248;TRRUST:11991950;TRRUST:12147248;TRRUST:15205382;TRRUST:15358113;TRRUST:18400206;TRRUST:19712670;TRRUST:22939842', 'omnipath': 'False', 'kinaseextra': 'False', 'ligrecextra': 'False', 'pathwayextra': 'False', 'mirnatarget': 'False', 'dorothea': 'True', 'collectri': 'True', 'tf_target': 'True', 'lncrna_mrna': 'False', 'tf_mirna': 'False', 'small_molecule': 'False', 'dorothea_curated': 'True', 'dorothea_chipseq': 'False', 'dorothea_tfbs': 'False', 'dorothea_coexp': 'False', 'dorothea_level': 'A;D', 'type': 'transcriptional', 'curation_effort': '21', 'extra_attrs': '{"CollecTRI_tf_category":"dbTF","CollecTRI_sign_decision":"default activation","DoRothEA_curated":true,"DoRothEA_chipseq":false,"DoRothEA_tfbs":false,"DoRothEA_coexp":false,"DoRothEA_level":["A","D"]}', 'evidences': '{"id_a":"P48281","id_b":"Q9JMA7","positive":[{"resource":"TRRUST","references":[],"dataset":"collectri","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":["default activation","PMID"]}},{"resource":"HTRI","references":[],"dataset":"collectri","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":"PMID"}},{"resource":"SIGNOR","references":[],"dataset":"collectri","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":"PMID"}},{"resource":"ExTRI","references":[],"dataset":"collectri","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":["default activation","PMID"]}},{"resource":"DoRothEA-A","references":[],"dataset":"collectri","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":"PMID"}},{"resource":"CollecTRI","references":["15205382","19581388","15358113","19712670","11991950","22939842","12167569","11723248","12147248","18400206"],"dataset":"collectri","via":null,"attrs":{"tf_category":"dbTF","sign_decision":["default activation","PMID"]}},{"resource":"HTRIdb","references":[],"dataset":"dorothea","via":"DoRothEA","attrs":{"curated":true,"chipseq":false,"tfbs":false,"coexp":false,"level":"A"}},{"resource":"TRRUST","references":[],"dataset":"dorothea","via":"DoRothEA","attrs":{"curated":true,"chipseq":false,"tfbs":false,"coexp":false,"level":"A"}},{"resource":"DoRothEA","references":[],"dataset":"dorothea","via":null,"attrs":{"curated":true,"chipseq":false,"tfbs":false,"coexp":false,"level":"A"}},{"resource":"TRRUST","references":["19712670","12147248"],"dataset":"tf_target","via":null,"attrs":{}},{"resource":"NTNU.Curated","references":[],"dataset":"collectri","via":"CollecTRI","attrs":{"tf_category":"dbTF","sign_decision":"default activation"}}],"negative":[],"directed":[],"undirected":[]}'}),
                    ]

    ontoweaver.transformer.register(OmniPath)

    data_mapping = {f"tests/{directory_name}/data.tsv": f"tests/{directory_name}/mapping.yaml"}

    nodes, edges = ontoweaver.extract(data_mapping, affix="suffix", raise_errors=False, sep = "\t")

    fnodes, fedges = ontoweaver.fusion.reconciliate(ontoweaver.ow2bc(nodes), ontoweaver.ow2bc(edges))

    assert_node_set = testing_functions.convert_to_set(assert_nodes)
    f_node_set = testing_functions.convert_to_set(fnodes)
    logging.debug(f_node_set)

    assert assert_node_set == f_node_set, "Nodes are not equal."

    assert_edge_set = testing_functions.convert_to_set(assert_edges)
    f_edge_set = testing_functions.convert_to_set(fedges)
    logging.debug(f_edge_set)

    assert assert_edge_set == f_edge_set, "Edges are not equal."


if __name__ == "__main__":
    test_custom_transformer()
